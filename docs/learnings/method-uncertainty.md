# 方法不確実性の学習記録

## [2025-07-21] - 頻度選択コンポーネントの実装パターン

### 状況
- ユーザーが年間頻度を入力する際、数値入力よりも選択式の方が使いやすい
- プリセット値とカスタム値の両方に対応する必要がある
- 既存のデータモデル（年間回数として保存）との互換性を保つ必要がある

### 学習内容
- Select要素とカスタム入力の組み合わせパターン
  - プリセット選択肢に「その他」オプションを追加
  - 「その他」選択時に条件付きでTextInputを表示
  - 状態管理: isCustomフラグとcustomValueの組み合わせ
- 選択肢のラベル設計
  - 頻度と年間回数を併記（例：「週1回 (52回/年)」）
  - ユーザーが直感的に理解できる表現
- コンポーネント設計の原則
  - 既存のUIコンポーネント（Select, TextInput）を再利用
  - 型安全性を保ちながら柔軟性を確保
  - テスタビリティを考慮した実装

## [2025-07-21] - 大切な人との予定管理機能の実装

### 状況
- 家族や大切な人との残り時間を可視化したい
- 子供の成長や親の年齢を考慮した節目までの残り回数を表示したい
- 予定を特定の人物に関連付ける機能が必要

### 学習内容
- 既存データモデルの活用
  - PersonEventモデルがすでに存在し、多対多の関連をサポート
  - untilAgeフィールドで節目年齢を設定可能
- UIの設計パターン
  - 予定追加フォームに人物選択を統合
  - 人物ごとに予定をグループ化して表示
  - デフォルトの節目年齢を関係性に応じて設定
- 残り回数計算の工夫
  - 子供: 18歳まで（成人まで）
  - 親: 85歳まで（平均寿命）
  - パートナー: 自分の健康寿命まで
  - その他: 30年または健康寿命のいずれか短い方

### 効果的だったアプローチ
1. 既存機能の拡張
   - 新しいモデルを作るのではなく、既存のPersonEventモデルを活用
   - 予定追加フォームに人物選択を追加するだけで実現
2. 情報の階層的表示
   - 人物ごとにカード形式で表示
   - 各カード内に予定と残り回数をリスト表示
   - 残り回数が少ない場合は赤色で強調
3. デフォルト値の賭い考慮
   - 関係性に応じた適切なデフォルト値を設定
   - ユーザーがカスタマイズ可能

### 今後の適用
- 既存機能の拡張パターン
  - 新機能を追加する前に、既存のモデルや機能を活用できないか検討
  - コードの重複を避け、メンテナンス性を向上
- 情報のグループ化と表示
  - 関連する情報をグループ化して表示
  - カードベースのUIで情報を整理

### 効果的だったアプローチ
1. 既存コンポーネントの組み合わせによる実装
   - Selectコンポーネントの拡張ではなく、ラッパーコンポーネントとして実装
   - 単一責任の原則を維持
2. プリセット値の定義
   - よく使われる頻度を網羅的にカバー
   - 値は実際の年間回数として保存（データモデルとの整合性）
3. カスタム値の検出ロジック
   - 初期値がプリセットに含まれない場合、自動的にカスタムモードに

### 今後の適用
- 類似の選択UIパターンで活用可能
  - プリセット＋カスタムの組み合わせが必要な場合
  - 例：期間選択、金額選択、距離選択など
- コンポーネント設計のベストプラクティス
  - 既存コンポーネントの再利用を優先
  - データモデルとUIの分離を意識
  - テストしやすい設計を心がける